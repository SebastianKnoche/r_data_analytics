---
title: "String Manipulation Challenge"
author: "Sebastian Knoche"
date: "2021-05-04"
output: html_document
---

## Reverse Strings

Write a function that reverses the order of the words of the input sentence.
```{r echo=FALSE}
# generate the sample string
my.sentence <- "here is long sentence, potentially generated by reading from some text-file"

my.wordSeqReverse <- function(any_string, any_split=" ", return_as_list=FALSE) {
  rev_word_seq <- paste0(
      rev(
        unlist(
          strsplit(
            any_string,
            split = any_split
            )
          )
        ),
      collapse = any_split
    )
  return(rev_word_seq)
}
```

```{r}
my.sentence
my.wordSeqReverse(my.sentence)
```

Now we want a function that keeps the order of the sentence, but
reverses the words!
```{r echo=FALSE}
my.strReverse <- function(any_string) {
  # split it into words
  tmp_words <- unlist(
    strsplit(
      any_string, split = " "
      )
    )
  # iterate over words
  for(i in seq_along(tmp_words)) {
    # replace each one with reversed order word
    tmp_words[i] <- my.wordSeqReverse(
      any_string = tmp_words[i],
      any_split = ""
      )
    }
  # recreate sentence with reversed words
  return(
    paste0(
      tmp_words,
      collapse = " "
      )
    )
}
```

```{r}
my.sentence
my.strReverse(my.sentence)
```

***

## 1 Remove Vowel

According to a linguistic theory, texts are still readable when the vowels are missing.

### 1.1 First Task:

Consider the following function `is.vowel(char)` which returns `TRUE` if the character is a vowel. Vowels are defined as `a`, `e`, `i`, `o` and `u`.

```{r}
is.vowel <- function(char) {
  if(char == "a" || char == "e" || char == "i" || char == "o" || char == "u")
    return(TRUE)
  return(FALSE)
}
```

Testing the function:
```{r}
is.vowel("e")
```

```{r}
is.vowel("f")
```

Tasks:

• Explain how the function works

> The Function checks if the given `char` is either one of the vowels defined and returns `TURE` or `FALSE` respectively. (It compares the value of `char` with each value for the vowels)

• What happens if we enter the following (and why):

```{r}
is.vowel(c("e","g"))
```

> `is.fowel()` checks if the first argument has the value associated with one of the vowels. `"e"` meets the criterium of `char == "e"`, so `TRUE` is returned. Either way, the first comparison leads to an execution of `return()` and therefore exits the function. All other values after the first one are ignored.


### 1.2 Extension

Now write a function `remove.vowels(string)` that removes all vowels in the sentence. Are the linguists right?

```{r echo=FALSE}
remove.vowels <- function(string) {
  # split it into words
  tmp_words <- unlist(
    strsplit(
      string, split = " "
      )
    )
  # iterate over words
  for(i in seq_along(tmp_words)) {
    tmp_word <- unlist(
      strsplit(
        tmp_words[i],
        split = ""
        )
      )
    # iterate over letters
    for(j in seq_along(tmp_word)) {
      # assign letter to the new word, but only if it is no vowel
      tmp_word[j] <- ifelse(is.vowel(tmp_word[j]), "", tmp_word[j])
    }
    # recreate word without vowels
    tmp_words[i] <- paste0(
      tmp_word,
      collapse = ""
    )
    }
  # recreate sentence without vowels
  return(
    paste0(
      tmp_words,
      collapse = " "
      )
    )
}
```


Testing the function (using strwrap is not necessary, but it improves ease of reading for pdf-files): We first enter a string:

```{r}
text.1 <- "Tours of the campus were very popular. Student guides showed more than 100 curious guests around the campus, answering a range of questions on the way."
strwrap(text.1)
```

Now we apply the function to the string:

```{r}
strwrap(remove.vowels(text.1) )
```

### 1.3 Sets

The function `is.element(el, set)` works on vectors and returns `TRUE` for each `el` in `set`. Example:

```{r echo=FALSE}
is.element <- function(el, set) {
  tmp_res <- c()
  for(i in seq_along(el)) {
    for(j in seq_along(set)) {
      tmp_res[i] <- el[i] == set[j]
    }
  }
  return(tmp_res)
}
```

```{r}
is.element(el=c("a","b","c"),set=c("i","a"))
```

Write down (on paper) a function `is.vowel.vect` that accepts a vector of characters as an input.

```{r echo=FALSE}
is.vowel.vect <- function(vowel.vect) {
  tmp_res <- c()
  for(i in seq_along(vowel.vect)) {
    tmp_res[i] <- is.vowel(vowel.vect[i])
  }
  return(tmp_res)
}
```

Testing

```{r}
is.vowel.vect(c("a","b","c","i"))
```

## 2 Interchange Letters

According to a second theory, it is still possible to read a text, if only the first and the last letter are on the right position and the rest is randomly interchanged.